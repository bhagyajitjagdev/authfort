---
title: Client API
description: Complete AuthClient reference.
sidebar:
  order: 6
---

import CodeBlock from '../../../components/CodeBlock.astro';

export const createExample = `import { createAuthClient } from 'authfort-client';

const auth = createAuthClient({
  baseUrl: '/auth',
  tokenMode: 'cookie',
});`;

export const tokenStorageInterface = `interface TokenStorage {
  get(): Promise<string | null>;
  set(token: string): Promise<void>;
  clear(): Promise<void>;
}`;

export const authUserType = `interface AuthUser {
  id: string;
  email: string;
  name?: string;
  roles: string[];
  emailVerified: boolean;
  avatarUrl?: string;
  createdAt: string;
}`;

export const authStateType = `type AuthState = 'authenticated' | 'unauthenticated' | 'loading';`;

export const authClientErrorType = `class AuthClientError extends Error {
  message: string;
  code: string;
  statusCode: number;
}`;

export const reactImport = `import { AuthProvider, useAuth } from 'authfort-client/react';`;

export const vueImport = `import { provideAuth, useAuth } from 'authfort-client/vue';`;

export const svelteImport = `import { createAuthStore } from 'authfort-client/svelte';`;

## createAuthClient(config)

Factory function that creates an `AuthClient` instance.

<CodeBlock code={createExample} lang="typescript" />

### AuthClientConfig

| Field | Type | Default | Description |
|-------|------|---------|-------------|
| `baseUrl` | `string` | — (required) | Auth server base URL |
| `tokenMode` | `'cookie' \| 'bearer'` | `'cookie'` | Token delivery mode |
| `refreshBuffer` | `number` | `30` | Seconds before expiry to trigger refresh |
| `tokenStorage` | `TokenStorage` | — | Required for bearer mode |

### TokenStorage

<CodeBlock code={tokenStorageInterface} lang="typescript" />

---

## AuthClient Methods

### `initialize()`

Check for an existing session on startup.

**Returns:** `Promise<void>`

### `signUp(data)`

Create a new user account.

| Param | Type | Description |
|-------|------|-------------|
| `data.email` | `string` | User email |
| `data.password` | `string` | Password |
| `data.name` | `string?` | Display name |

**Returns:** `Promise<AuthUser>`
**Throws:** `AuthClientError`

### `signIn(data)`

Authenticate with email and password.

| Param | Type | Description |
|-------|------|-------------|
| `data.email` | `string` | User email |
| `data.password` | `string` | Password |

**Returns:** `Promise<AuthUser>`
**Throws:** `AuthClientError`

### `signInWithProvider(provider)`

Start OAuth flow by redirecting to the provider.

| Param | Type | Description |
|-------|------|-------------|
| `provider` | `string` | `'google'` or `'github'` |

**Returns:** `void` (navigates the browser)

### `signOut()`

Revoke the refresh token and clear auth state.

**Returns:** `Promise<void>`

### `getUser()`

Get the current user from the server.

**Returns:** `Promise<AuthUser>`
**Throws:** `AuthClientError` if not authenticated

### `getToken()`

Get a valid access token. Refreshes automatically if expired.

**Returns:** `Promise<string | null>` — `null` in cookie mode

### `fetch(url, options?)`

Make an authenticated request. Retries once on 401.

| Param | Type | Description |
|-------|------|-------------|
| `url` | `string` | Request URL |
| `options` | `RequestInit?` | Standard fetch options |

**Returns:** `Promise<Response>`

### `onAuthStateChange(callback)`

Listen for auth state changes.

| Param | Type | Description |
|-------|------|-------------|
| `callback` | `(state: AuthState, user: AuthUser \| null) => void` | State change handler |

**Returns:** `() => void` — unsubscribe function

---

## Types

### AuthUser

<CodeBlock code={authUserType} lang="typescript" />

### AuthState

<CodeBlock code={authStateType} lang="typescript" />

### AuthClientError

<CodeBlock code={authClientErrorType} lang="typescript" />

---

## Framework Integrations

### React

<CodeBlock code={reactImport} lang="typescript" />

| Export | Description |
|--------|-------------|
| `AuthProvider` | Context provider component. Props: `client: AuthClient` |
| `useAuth()` | Hook returning `{ state, user, isAuthenticated, isLoading, client }` |

### Vue

<CodeBlock code={vueImport} lang="typescript" />

| Export | Description |
|--------|-------------|
| `provideAuth(client)` | Provide auth to component tree |
| `useAuth()` | Composable returning `{ state, user, isAuthenticated, isLoading, client }` |

### Svelte

<CodeBlock code={svelteImport} lang="typescript" />

| Export | Description |
|--------|-------------|
| `createAuthStore(client)` | Returns `{ state, user, isAuthenticated, isLoading, client }` as Svelte stores |
