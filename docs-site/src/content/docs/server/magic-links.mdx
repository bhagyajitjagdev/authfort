---
title: Magic Links
description: Passwordless login via email links.
sidebar:
  order: 16
---

import { Steps } from '@astrojs/starlight/components';
import CodeBlock from '../../../components/CodeBlock.astro';

export const requestEndpoint = `POST /auth/magic-link
Content-Type: application/json

{"email": "user@example.com"}`;

export const requestProgrammatic = `token = await auth.create_magic_link_token(email)
# Returns token string, or None if user not found`;

export const deliverHook = `@auth.on("magic_link_requested")
async def send_magic_link(event):
    await send_email(
        to=event.email,
        body=f"https://myapp.com/auth/magic?token={event.token}",
    )`;

export const verifyEndpoint = `POST /auth/magic-link/verify
Content-Type: application/json

{"token": "..."}`;

export const verifyProgrammatic = `result = await auth.verify_magic_link(token)
# Returns AuthResponse with tokens and user`;

export const autoSignupConfig = `auth = AuthFort(
    database_url="...",
    allow_passwordless_signup=True,
)`;

export const clientExample = `await auth.requestMagicLink('user@example.com');

// User clicks link in email, your app extracts the token
const user = await auth.verifyMagicLink(token);`;

Magic links provide passwordless authentication. Users click a link in their email to log in — no password needed. AuthFort handles token generation and verification; you handle email delivery via event hooks.

## How It Works

<Steps>

1. **Request a magic link**

   Via the built-in endpoint:

   <CodeBlock code={requestEndpoint} lang="http" />

   Always returns 200 regardless of whether the email exists (prevents enumeration).

   Or programmatically:

   <CodeBlock code={requestProgrammatic} lang="python" />

2. **Deliver the link**

   Use the `magic_link_requested` event hook:

   <CodeBlock code={deliverHook} lang="python" />

3. **Verify and login**

   Via the built-in endpoint:

   <CodeBlock code={verifyEndpoint} lang="http" />

   Returns an `AuthResponse` with tokens and user data. Sets cookies automatically if cookie mode is enabled.

   Or programmatically:

   <CodeBlock code={verifyProgrammatic} lang="python" />

</Steps>

## Auto-Signup

By default, magic links only work for existing users. Set `allow_passwordless_signup=True` to auto-create accounts:

<CodeBlock code={autoSignupConfig} lang="python" />

:::note
Auto-created users have no password and cannot use email/password login. They can set a password later via the password reset flow. This flag is independent of `allow_signup` — you can set `allow_signup=False` to block email/password registration while still allowing passwordless sign-up.
:::

## Email Verification

Magic link login automatically sets `email_verified=True` — no separate verification step needed.

## Security

| Property | Detail |
|----------|--------|
| Token lifetime | Single-use, expires after `magic_link_ttl` (default: 10 minutes) |
| Ban enforcement | Banned users cannot use magic links |
| Token invalidation | Requesting a new magic link invalidates any previous token |

## Events

Emits `magic_link_requested` (includes `token` for delivery), `magic_link_login`, and optionally `user_created` (if auto-signup creates a new account).

See [Events & Hooks](/authfort/server/events/) for all events and their payloads.

## Client SDK

<CodeBlock code={clientExample} lang="typescript" />
